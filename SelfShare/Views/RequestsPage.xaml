<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:models="clr-namespace:SelfShare.Models"
             x:Class="SelfShare.Views.RequestsPage"
             Title="Requests"
             Shell.NavBarIsVisible="False"
             BackgroundColor="#F5F5F5">

    <Grid RowDefinitions="Auto, Auto, *">

        <Grid Grid.Row="0" BackgroundColor="#2D9CDB" Padding="20,15,20,20" HeightRequest="80">
            <Label Text="Request" 
                   TextColor="White" 
                   FontSize="24" 
                   FontAttributes="Bold" 
                   HorizontalOptions="Center"
                   VerticalOptions="Center"/>
        </Grid>

        <Frame Grid.Row="1" 
               Margin="20,15" 
               Padding="5" 
               CornerRadius="10" 
               BackgroundColor="#E0E0E0" 
               HasShadow="False"
               HeightRequest="50">

            <Grid ColumnDefinitions="*,*">
                <Button x:Name="BtnIncoming"
                        Text="Incoming"
                        Grid.Column="0"
                        BackgroundColor="#2D9CDB"
                        TextColor="White"
                        CornerRadius="8"
                        FontAttributes="Bold"
                        Clicked="OnIncomingClicked"/>

                <Button x:Name="BtnOutgoing"
                        Text="Outgoing"
                        Grid.Column="1"
                        BackgroundColor="Transparent"
                        TextColor="#666"
                        CornerRadius="8"
                        FontAttributes="Bold"
                        Clicked="OnOutgoingClicked"/>
            </Grid>
        </Frame>

        <CollectionView Grid.Row="2" x:Name="RequestsCollection" Margin="20,0,20,20">
            <CollectionView.ItemTemplate>
                <DataTemplate x:DataType="models:RequestModel">
                    <Frame Margin="0,5" Padding="15" CornerRadius="12" HasShadow="True" BackgroundColor="White" BorderColor="Transparent">
                        <Grid ColumnDefinitions="60, *" RowDefinitions="Auto, Auto" ColumnSpacing="15">

                            <Frame Grid.Row="0" Grid.Column="0" Grid.RowSpan="2"
                                   Padding="0"
                                   CornerRadius="8"
                                   IsClippedToBounds="True"
                                   HeightRequest="80"
                                   WidthRequest="60"
                                   BorderColor="Transparent">

                                <Image Source="{Binding ImageUrl}" 
                                       Aspect="AspectFill"
                                       HeightRequest="80" 
                                       WidthRequest="60" />
                            </Frame>

                            <VerticalStackLayout Grid.Row="0" Grid.Column="1" Spacing="2">
                                <Label Text="{Binding Title}" FontSize="16" FontAttributes="Bold" TextColor="#333"/>
                                <Label Text="{Binding UserName, StringFormat='from {0}'}" FontSize="13" TextColor="#999"/>
                            </VerticalStackLayout>

                            <Grid Grid.Row="1" Grid.Column="1" Margin="0,10,0,0">

                                <Grid IsVisible="{Binding IsIncoming}" ColumnDefinitions="*, *" ColumnSpacing="10">

                                    <Button Grid.Column="0" 
            Text="Accept" 
            BackgroundColor="#D1E9FC" 
            TextColor="#2D9CDB"
            HeightRequest="35" 
            Padding="0" 
            CornerRadius="8" 
            FontSize="12" 
            FontAttributes="Bold"
            Clicked="OnAcceptClicked" 
            CommandParameter="{Binding .}" />
                                    <Button Grid.Column="1" 
            Text="Decline" 
            BackgroundColor="#F0F0F0" 
            TextColor="#333" 
            HeightRequest="35" 
            Padding="0" 
            CornerRadius="8" 
            FontSize="12" 
            FontAttributes="Bold"
            Clicked="OnDeclineClicked"
            CommandParameter="{Binding .}" />
                                </Grid>

                                <Frame IsVisible="{Binding IsOutgoing}" 
                                       HorizontalOptions="End" 
                                       Padding="10,5" 
                                       BackgroundColor="#FFF9C4" 
                                       CornerRadius="8" 
                                       HasShadow="False">
                                    <Label Text="Pending" TextColor="#FBC02D" FontSize="12" FontAttributes="Bold"/>
                                </Frame>

                            </Grid>
                        </Grid>
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

    </Grid>
</ContentPage>